<div title="Lista de eventos" class="events-list events-list-win active">
	
	
		<div class="events-list pagination">			
			<input name="results" type="hidden" value="<%=data.count%>"></input>
			<input name="page_index" type="hidden" value="<%=data.page_index%>"></input>
			<input name="keyword" type="hidden" value="<%=data.keyword%>"></input>
		</div>
	
	<table cellspacing='0' cellpadding='0'>
		<tbody>
			<% //for (var i=0; i<data.events_list.length; i++)
				for (var i in data.events_list)	{ %>		
				<% for (j=0; j<data.events_list[i].events.length; j++) { %>
					<!-- a variável _event é um alias para data.events_list[i].events[j] -->
					<% var _event =  data.events_list[i].events[j]; 
					 	// se houver mais de um evento no mesmo dia...
						if (data.events_list[i].events.length > 1) { %>
							<!-- se não for a última linha do evento multiplo no mesmo dia... -->
							<% if (data.events_list[i].events.length != j+1) { %>
								<tr class='start-date same-start-date'>
							<% } else { %> <!-- se for a ultima linha do evento multiplo no mesmo dia... -->
								<tr class='start-date same-start-date last-event-same-start-date'>
							<% } %>
							
							<% if (j==0) { %>
								<!-- coluna 1 - multiplos eventos na mesma data -->
								<th width='100' rowspan='<%= data.events_list[i].events.length %>' class='start-date start-date-multiple-events'>
								<span><%= data.events_list[i].startDate %></span>
                                                                </th>
							<% } %>
						<% } else {  %>
								<tr> 
								<% if (j>0) %>
									<!-- coluna 1 - evento unico na mesma data -->
									<th width='100' class="start-date">
										<span><%= data.events_list[i].startDate %></span> <% 
								} %>
									</th>
					<td width='100'>
						<span><%= _event.time %></span>
					</td>
					<td>
						<span>
							<a class="title event-details-item" title='<%= _event.summary %>' aria-expanded='false' role='button' tabindex='0'><%= _event.summary %></a>
							<!-- TODO: FAZER FUNCIONAR DESTA FORMA -->
							<%
						    /*
							var title     = "";
							var url_image = "";
							if (_event.repeat) {
								title	  = "Este evento tem repetição";
								url_image = "img/repeat.png";
							}
							if ((_event.alarms) && (_event.alarms.length > 0)) {
								title	  = "Este evento tem lembretes";
								url_image = "img/alarm.png";
							}
							if ((_event.attachments) && (_event.attachments.length > 0)) {
								title	  = "Este evento tem anexos";
								url_image = "img/attachment.png";
							}
							if ((_event.participants) && (_event.participants.length > 0)) {
								title	  = "Este evento tem participantes";
								url_image = "img/user.png";
							}
						    */						
							%>
							<!-- <img title='<%= title %>' src='<%= url_image %>'> -->
							<!-- ESSA FORMA DE EXIBIR AS OPÇÕES É ARCAICA, SUBSTITUIR PELO CÓDIGO ACIMA DEPOIS DE AJUSTADO -->
							<% if (_event.options) {
								for (var o=0; o < _event.options.length; o++) {
								var url_image = "";
								var type_option = _event.options[o].type;
								if (type_option == "repeat")
									url_image = "img/repeat.png";
								if (type_option == "alarm")
									url_image = "img/alarm.png"; 
								if (type_option == "attachment")
									url_image = "img/attachment.png";
								if (type_option == "participant")
									url_image = "img/user.png"; %>
								<img title='<%= _event.options[o].title %>' src='<%= url_image %>'> <% 
								}
							} 							
							%>
						</span>	
						<div class="details-event-list hidden">
							<fieldset class="fields-details-event-list">							
								<%if(_event.allDay){%>
									<p class="input-group date-info">
										<label>Duração</label>
										<span class="">Dia inteiro</span>
									</p>
								<%}else{%>
								
									<p class="input-group date-info">
										<label>Início:</label>
										<span class=""><%= _event.startDate %> às </span>
										<span class=""><%= _event.startHour %></span> 
										
									</p>
									<p class="input-group">
										<label>Término:</label>
										<span class=""><%= _event.endDate %> às </span>
										<span class=""><%= _event.endHour %></span>
										<span><%= _event.timeZone %></span>
									</p>
								<%}%>
								<%if(_event.repeat ){%>
								    <p class="input-group">
									<label>Repetição</label>
									<span><%= _event.repeat %></span>
								    </p>
								<%}%>
								<p class="input-group">
									<label>Lembretes</label>
									<% if(_event.alarms) { %>
										<span class="large" >
											<% for (var l=0; l < _event.alarms.length; l++) { %>
												<span class="large" >Você será notificado por um <%=dateCalendar.alarmtype[_event.alarms[l].type]%> <%= _event.alarms[l].time %> <%= dateCalendar.timeunit[_event.alarms[l].unit]%><%=_event.alarms[l].time > 1 ? 's' : '' %> antes do evento</span>
											<% } %>
										</span>
									<% } %>
								</p>
								<p class="input-group">
									<label>Local</label>
									<span><%= _event.location %></span>
								</p>
								<p class="input-group">
									<label>Descrição </label>
									<span class="large" ><%= _event.description %></span>
								</p>
								<!--<p class="input-group">
									<label>Privacidade</label>
									<span><%= _event.privacy %></span>
								</p>-->
								<p class="input-group">
									<label>Organizador</label>
									<span class="large"><%= _event.organizer.user ? _event.organizer.user.name : _event.organizer.name %>  (<%= _event.organizer.user ? _event.organizer.user.mail : _event.organizer.mail %>)</span>
								</p>
								<p class="input-group">
									<label>Participantes</label>
									<% if(_event.attendee) { %>
										<span class="large" >
											<% for (var m=0; m < _event.attendee.length; m++) { %>
												<span class="large"><%=_event.attendee[m].name%>  (<%= _event.attendee[m].mail %>)</span>
											<%}%>
										</span>
									<% } %>
								</p>
								<p class="input-group">
									<label>Presença</label>
									<span>
                                                                            <% var status_name;
                                                                                if (_event.status == 1)
                                                                                    status_name = "Eu vou";
                                                                                else if (_event.status == 2)
                                                                                    status_name = "Talvez";
                                                                                else if (_event.status == 3)
                                                                                    status_name = "Eu não vou";
                                                                            %>
                                                                            <%= status_name %>
                                                                        </span> <!-- Ta hardcodificado isso aqui? -->
								</p>
							</fieldset>
							<div class="menu-container footer-container">
								<input name="eventid" type="hidden" value="<%=_event.id%>"></input>
                                                                <input name="calendarid" type="hidden" value="<%=_event.calendar%>"></input>
								<a title="Excluir" class="button delete" href="#">Excluir</a>
								<a title="Editar" class="button edit" href="#">Editar</a>
							</div>
						</div>
	
					</td>				
				</tr>
				<% } %>		
			<% } //final do for %>
		</tbody>
	</table>
	<div class="pagination-events"></div>
</div> 

